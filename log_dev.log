W0903 00:26:32.941915  9176 device_context.cc:252] Please NOTE: device: 0, CUDA Capability: 70, Driver API Version: 10.1, Runtime API Version: 9.0
W0903 00:26:32.946799  9176 device_context.cc:260] device: 0, cuDNN Version: 7.6.
/home/aistudio/work/stargan-v2-paddle-master/core/batch_sampler.py:144: FutureWarning: arrays to stack must be passed as a "sequence" type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  imgs = np.stack((self.dataset[i][0] for i in batch_indices), axis=0)
/home/aistudio/work/stargan-v2-paddle-master/core/batch_sampler.py:145: FutureWarning: arrays to stack must be passed as a "sequence" type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  idx = np.stack((self.dataset[i][1] for i in batch_indices), axis=0)
/home/aistudio/work/stargan-v2-paddle-master/core/batch_sampler.py:148: FutureWarning: arrays to stack must be passed as a "sequence" type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  imgs = np.stack((self.dataset[i][0] for i in batch_indices), axis=0)
/home/aistudio/work/stargan-v2-paddle-master/core/batch_sampler.py:149: FutureWarning: arrays to stack must be passed as a "sequence" type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  imgs2 = np.stack((self.dataset[i][1] for i in batch_indices), axis=0)
/home/aistudio/work/stargan-v2-paddle-master/core/batch_sampler.py:150: FutureWarning: arrays to stack must be passed as a "sequence" type such as list or tuple. Support for non-sequence iterables such as generators is deprecated as of NumPy 1.16 and will raise an error in the future.
  idx = np.stack((np.array(self.dataset[i][2]) for i in batch_indices), axis=0)
Namespace(batch_size=2, beta1=0.0, beta2=0.99, checkpoint_dir='expr/checkpoints', ds_iter=100000, eval_dir='expr/eval', eval_every=50000, f_lr=1e-06, hidden_dim=16, img_size=256, inp_dir='assets/representative/custom/female', lambda_cyc=1, lambda_ds=1, lambda_reg=1, lambda_sty=1, latent_dim=8, lm_path='expr/checkpoints/celeba_lm_mean.npz', lr=0.0001, mode='train', num_domains=2, num_outs_per_domain=4, num_workers=4, out_dir='assets/representative/celeba_hq/src/female', print_every=1, randcrop_prob=0.5, ref_dir='assets/representative/celeba_hq/ref', result_dir='expr/results', resume_iter=0, sample_dir='expr/samples', sample_every=1, save_every=1, seed=777, src_dir='assets/representative/celeba_hq/src', style_dim=4, total_iters=3, train_img_dir='data_dev/celeba_hq/train', val_batch_size=2, val_img_dir='data_dev/celeba_hq/val', w_hpf=0.0, weight_decay=0.0001, whichgpu=0, wing_path='expr/checkpoints/wing.ckpt')
Preparing DataLoader to fetch source images during the training phase...
Preparing DataLoader to fetch reference images during the training phase...
Preparing DataLoader for the generation phase...
Start training...
Elapsed time [0:00:05], Iteration [1/3], D/latent_real: [1.3868] D/latent_fake: [0.0000] D/latent_reg: [0.0000] D/ref_real: [1.3868] D/ref_fake: [0.0000] D/ref_reg: [0.0000] G/latent_adv: [1.4646] G/latent_sty: [0.8091] G/latent_ds: [0.0028] G/latent_cyc: [0.8933] G/ref_adv: [4.7942] G/ref_sty: [2.0235] G/ref_ds: [0.0768] G/ref_cyc: [0.9831] G/lambda_ds: [1.0000]
Saving checkpoint of para into expr/checkpoints/000001_nets_ema_generator...
Saving checkpoint of para into expr/checkpoints/000001_nets_generator...
Saving checkpoint of opti into expr/checkpoints/000001_nets_generator...
Saving checkpoint of para into expr/checkpoints/000001_nets_ema_mapping_network...
Saving checkpoint of para into expr/checkpoints/000001_nets_mapping_network...
Saving checkpoint of opti into expr/checkpoints/000001_nets_mapping_network...
state_dict is empty, no need to save
Saving checkpoint of para into expr/checkpoints/000001_nets_ema_style_encoder...
Saving checkpoint of para into expr/checkpoints/000001_nets_style_encoder...
Saving checkpoint of opti into expr/checkpoints/000001_nets_style_encoder...
state_dict is empty, no need to save
'discriminator'
Elapsed time [0:00:17], Iteration [2/3], D/latent_real: [1.7153] D/latent_fake: [0.0000] D/latent_reg: [0.0000] D/ref_real: [1.7153] D/ref_fake: [0.0000] D/ref_reg: [0.0000] G/latent_adv: [2.8012] G/latent_sty: [1.2405] G/latent_ds: [0.0048] G/latent_cyc: [0.7892] G/ref_adv: [1.4279] G/ref_sty: [1.1545] G/ref_ds: [0.0908] G/ref_cyc: [0.7003] G/lambda_ds: [1.0000]
Saving checkpoint of para into expr/checkpoints/000002_nets_ema_generator...
Saving checkpoint of para into expr/checkpoints/000002_nets_generator...
Saving checkpoint of opti into expr/checkpoints/000002_nets_generator...
Saving checkpoint of para into expr/checkpoints/000002_nets_ema_mapping_network...
Saving checkpoint of para into expr/checkpoints/000002_nets_mapping_network...
Saving checkpoint of opti into expr/checkpoints/000002_nets_mapping_network...
state_dict is empty, no need to save
Saving checkpoint of para into expr/checkpoints/000002_nets_ema_style_encoder...
Saving checkpoint of para into expr/checkpoints/000002_nets_style_encoder...
Saving checkpoint of opti into expr/checkpoints/000002_nets_style_encoder...
state_dict is empty, no need to save
'discriminator'
Elapsed time [0:00:29], Iteration [3/3], D/latent_real: [1.4242] D/latent_fake: [0.0000] D/latent_reg: [0.0000] D/ref_real: [1.4242] D/ref_fake: [0.0000] D/ref_reg: [0.0000] G/latent_adv: [1.5476] G/latent_sty: [1.5161] G/latent_ds: [0.0030] G/latent_cyc: [0.6447] G/ref_adv: [2.3767] G/ref_sty: [1.0965] G/ref_ds: [0.0831] G/ref_cyc: [0.7301] G/lambda_ds: [1.0000]
Saving checkpoint of para into expr/checkpoints/000003_nets_ema_generator...
Saving checkpoint of para into expr/checkpoints/000003_nets_generator...
Saving checkpoint of opti into expr/checkpoints/000003_nets_generator...
Saving checkpoint of para into expr/checkpoints/000003_nets_ema_mapping_network...
Saving checkpoint of para into expr/checkpoints/000003_nets_mapping_network...
Saving checkpoint of opti into expr/checkpoints/000003_nets_mapping_network...
state_dict is empty, no need to save
Saving checkpoint of para into expr/checkpoints/000003_nets_ema_style_encoder...
Saving checkpoint of para into expr/checkpoints/000003_nets_style_encoder...
Saving checkpoint of opti into expr/checkpoints/000003_nets_style_encoder...
state_dict is empty, no need to save
'discriminator'
